--- configure	2009-11-28 03:33:54.961467916 +0100
+++ configure.new	2009-11-28 03:35:48.731467571 +0100
@@ -330,8 +330,8 @@
   #       common.make
   UNAME=`uname`
   if [ "X${UNAME}" = "XLinux" ];then
-    UNAME=`uname -p`
-    if [ ${UNAME} = x86_64 -o ${UNAME} = sparc64 -o ${UNAME} = ppc64 ];then
+    UNAME=`uname -m`
+    if [ "X${UNAME}" = "Xx86_64" -o "X${UNAME}" = "Xsparc64" -o "X${UNAME}" = "Xppc64" ];then
       cfgwrite "CGS_LIBDIR_NAME:=lib64"
     else
       cfgwrite "CGS_LIBDIR_NAME:=lib"
@@ -343,7 +343,8 @@
   cfgwrite "CONFIGURE_FHS_INSTALL_LIBDIR:=\$(FHS_INSTALL_ROOT)/\$(CGS_LIBDIR_NAME)/"
   cfgwrite "CONFIGURE_SYSTEM_LIB_DIR += -L\$(CONFIGURE_FHS_INSTALL_LIBDIR)"
   cfgwrite "endif"
-  cfgwrite "GNUSTEP_INSTALLATION_DOMAIN:=LOCAL"
+  cfgwrite "GNUSTEP_INSTALLATION_DOMAIN:=SYSTEM"
+  cfgwrite "GNUSTEP_WEB_APPS:=\${GNUSTEP_SYSTEM_WEB_APPS}"
   cfgwrite "CONFIGURE_SYSTEM_LIB_DIR += -L/usr/\$(CGS_LIBDIR_NAME)/"
   
   
@@ -425,6 +426,7 @@
   cd $tmpdir
   cp ../maintenance/dummytool.c .
 
+  local OLDLIBS="${LIBS}"
   for LIB in $1;do
     LIBS="$LIBS -l${LIB}"
   done
@@ -447,16 +449,24 @@
   LINK_RESULT=$?
   
   if test $LINK_RESULT = 0; then
-    echo "$2 library found: $1"
-    cfgwrite "HAS_LIBRARY_$1=yes"
+    for LIB in $1;do
+      echo "$2 library found: ${LIB}"
+      cfgwrite "HAS_LIBRARY_${LIB}=yes"
+    done
   else
     if test "x$2" = "xrequired"; then
-      echo "failed to link $2 library: $1"
+      for LIB in $1;do
+        echo "failed to link $2 library: ${LIB}"
+        cfgwrite "HAS_LIBRARY_${LIB}=no"
+      done
       rm ../config.make
       exit 1
     else
-      echo "failed to link $2 library: $1"
-      cfgwrite "HAS_LIBRARY_$1=no"
+      for LIB in $1;do
+        echo "failed to link $2 library: ${LIB}"
+        cfgwrite "HAS_LIBRARY_${LIB}=no"
+      done
+      LIBS="${OLDLIBS}"
     fi
   fi
   
